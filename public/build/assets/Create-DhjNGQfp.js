import{u as A,s as p,b as m,d as o,e,h as D,w as r,f as t,v as y,j as d,p as F,m as c,k as n,F as v,z as k,i as C,t as u,C as P,D as E}from"./app-tXC2pLZf.js";import{_ as L}from"./AppLayout.vue_vue_type_script_setup_true_lang-BHJDPCZ8.js";import{_ as x}from"./AppFooter-TW4fO1XT.js";import{_ as U,a as j,b as z}from"./CardHeader.vue_vue_type_script_setup_true_lang-DkfxRezm.js";import{_ as T}from"./CardDescription.vue_vue_type_script_setup_true_lang-CIi_TT5h.js";import{_ as H}from"./CardTitle.vue_vue_type_script_setup_true_lang-B_mxAcVg.js";import{_ as R}from"./Input.vue_vue_type_script_setup_true_lang-DRUFobxk.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-B_HSfrJG.js";import{_ as q,a as V,b as $,c as S,d as N}from"./SelectItem.vue_vue_type_script_setup_true_lang-DhfW_bte.js";import{e as G,s as I}from"./useSweetAlert-DaBq0Crb.js";import{A as J}from"./arrow-left-C1IfUB_V.js";import"./useForwardExpose-Bfd518nw.js";import"./RovingFocusGroup-BNHTgRLt.js";import"./ThemeSwitcher.vue_vue_type_script_setup_true_lang-DAe2Mvpc.js";import"./VisuallyHidden-BH3P4Ghq.js";import"./check-B_vWNd7n.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const K={class:"py-12"},O={class:"mx-auto max-w-4xl sm:px-6 lg:px-8"},Q={class:"mb-4"},W={class:"space-y-2"},X={key:0,class:"text-sm text-destructive"},Y={class:"space-y-2"},Z={key:0,class:"text-sm text-destructive"},ee={key:0,class:"rounded-lg border p-4 bg-muted/50"},se={class:"grid grid-cols-2 gap-2 text-sm"},te={class:"ml-2 font-medium"},ae={class:"ml-2 font-medium"},oe={class:"space-y-2"},re={key:0,class:"text-sm text-destructive"},ie={class:"text-sm text-muted-foreground"},ue={key:1,class:"rounded-lg border p-4 bg-blue-50 dark:bg-blue-950"},de={class:"space-y-2 text-sm"},le={class:"ml-2 font-medium text-blue-600 dark:text-blue-400"},ne={class:"ml-2 font-medium"},me={class:"ml-2 font-medium"},ce={class:"pt-2 border-t"},pe={class:"text-xs text-muted-foreground"},fe={class:"flex items-center space-x-2"},_e={class:"flex justify-end gap-3"},De={__name:"Create",props:{clientes:Array,paquetes:Array},setup(_){const h=_,a=A({usuario_id:"",paquete_id:"",renovacion_automatica:!1,cuotas:1}),l=p(()=>a.paquete_id?h.paquetes.find(g=>g.id===a.paquete_id):null),b=p(()=>l.value?Math.floor(l.value.membresia.duracion_dias/2):1),w=p(()=>!l.value||a.cuotas<1?0:(l.value.precio/a.cuotas).toFixed(2)),B=p(()=>!l.value||a.cuotas<1?0:Math.floor(l.value.membresia.duracion_dias/a.cuotas)),M=()=>{a.post("/suscripciones",{onSuccess:()=>{I({title:"¡Creado!",text:"La suscripción ha sido creada correctamente"})},onError:()=>{G({title:"Error",text:"Hubo un problema al crear la suscripción"})}})};return(g,s)=>(n(),m(v,null,[o(e(D),{title:"Nueva Suscripción"}),o(L,null,{header:r(()=>[...s[4]||(s[4]=[t("h2",{class:"text-xl font-semibold leading-tight text-foreground"}," Nueva Suscripción ",-1)])]),default:r(()=>[t("div",K,[t("div",O,[t("div",Q,[o(e(x),{variant:"ghost",size:"sm","as-child":""},{default:r(()=>[o(e(y),{href:"/suscripciones"},{default:r(()=>[o(e(J),{class:"mr-2 h-4 w-4"}),s[5]||(s[5]=d(" Volver al listado ",-1))]),_:1})]),_:1})]),o(e(U),null,{default:r(()=>[o(e(j),null,{default:r(()=>[o(e(H),null,{default:r(()=>[...s[6]||(s[6]=[d("Crear Nueva Suscripción",-1)])]),_:1}),o(e(T),null,{default:r(()=>[...s[7]||(s[7]=[d(" Complete los datos para crear una nueva suscripción. Los pagos se generarán automáticamente. ",-1)])]),_:1})]),_:1}),o(e(z),null,{default:r(()=>[t("form",{onSubmit:F(M,["prevent"]),class:"space-y-6"},[t("div",W,[o(e(f),{for:"usuario_id"},{default:r(()=>[...s[8]||(s[8]=[d("Cliente *",-1)])]),_:1}),o(e(q),{modelValue:e(a).usuario_id,"onUpdate:modelValue":s[0]||(s[0]=i=>e(a).usuario_id=i),required:""},{default:r(()=>[o(e(V),{id:"usuario_id"},{default:r(()=>[o(e($),{placeholder:"Selecciona un cliente"})]),_:1}),o(e(S),null,{default:r(()=>[(n(!0),m(v,null,k(_.clientes,i=>(n(),C(e(N),{key:i.id,value:i.id},{default:r(()=>[d(u(i.name)+" - "+u(i.email),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(a).errors.usuario_id?(n(),m("span",X,u(e(a).errors.usuario_id),1)):c("",!0)]),t("div",Y,[o(e(f),{for:"paquete_id"},{default:r(()=>[...s[9]||(s[9]=[d("Paquete *",-1)])]),_:1}),o(e(q),{modelValue:e(a).paquete_id,"onUpdate:modelValue":s[1]||(s[1]=i=>e(a).paquete_id=i),required:""},{default:r(()=>[o(e(V),{id:"paquete_id"},{default:r(()=>[o(e($),{placeholder:"Selecciona un paquete"})]),_:1}),o(e(S),null,{default:r(()=>[(n(!0),m(v,null,k(_.paquetes,i=>(n(),C(e(N),{key:i.id,value:i.id},{default:r(()=>[d(u(i.nombre)+" - Bs "+u(Number(i.precio).toFixed(2))+" ("+u(i.membresia.nombre)+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(a).errors.paquete_id?(n(),m("span",Z,u(e(a).errors.paquete_id),1)):c("",!0)]),l.value?(n(),m("div",ee,[s[12]||(s[12]=t("h4",{class:"text-sm font-medium mb-2"},"Detalles del Paquete",-1)),t("div",se,[t("div",null,[s[10]||(s[10]=t("span",{class:"text-muted-foreground"},"Precio:",-1)),t("span",te,"Bs "+u(Number(l.value.precio).toFixed(2)),1)]),t("div",null,[s[11]||(s[11]=t("span",{class:"text-muted-foreground"},"Duración:",-1)),t("span",ae,u(l.value.membresia.duracion_dias)+" días",1)])])])):c("",!0),t("div",oe,[o(e(f),{for:"cuotas"},{default:r(()=>[...s[13]||(s[13]=[d("Número de Cuotas *",-1)])]),_:1}),o(e(R),{id:"cuotas",modelValue:e(a).cuotas,"onUpdate:modelValue":s[2]||(s[2]=i=>e(a).cuotas=i),modelModifiers:{number:!0},type:"number",min:"1",max:b.value,required:""},null,8,["modelValue","max"]),e(a).errors.cuotas?(n(),m("span",re,u(e(a).errors.cuotas),1)):c("",!0),t("p",ie," Mínimo 1 cuota, máximo "+u(b.value)+" cuotas (duración en días / 2) ",1)]),l.value&&e(a).cuotas>=1?(n(),m("div",ue,[s[17]||(s[17]=t("h4",{class:"text-sm font-medium mb-2"},"Cálculo de Pagos",-1)),t("div",de,[t("div",null,[s[14]||(s[14]=t("span",{class:"text-muted-foreground"},"Monto por cuota:",-1)),t("span",le,"Bs "+u(w.value),1)]),t("div",null,[s[15]||(s[15]=t("span",{class:"text-muted-foreground"},"Días entre pagos:",-1)),t("span",ne,u(B.value)+" días",1)]),t("div",null,[s[16]||(s[16]=t("span",{class:"text-muted-foreground"},"Total de cuotas:",-1)),t("span",me,u(e(a).cuotas),1)]),t("div",ce,[t("p",pe," Se crearán "+u(e(a).cuotas)+' pago(s) con estado "impaga". El primer pago vence mañana. ',1)])])])):c("",!0),t("div",fe,[P(t("input",{id:"renovacion_automatica",type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=i=>e(a).renovacion_automatica=i),class:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[E,e(a).renovacion_automatica]]),o(e(f),{for:"renovacion_automatica",class:"cursor-pointer"},{default:r(()=>[...s[18]||(s[18]=[d(" Renovación automática ",-1)])]),_:1})]),t("div",_e,[o(e(x),{type:"button",variant:"outline","as-child":""},{default:r(()=>[o(e(y),{href:"/suscripciones"},{default:r(()=>[...s[19]||(s[19]=[d("Cancelar",-1)])]),_:1})]),_:1}),o(e(x),{type:"submit",disabled:e(a).processing},{default:r(()=>[d(u(e(a).processing?"Creando...":"Crear Suscripción"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1})])])]),_:1})],64))}};export{De as default};
