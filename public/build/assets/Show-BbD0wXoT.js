import{r as k,u as z,b as f,d as s,e as t,h as U,w as a,f as o,v as y,j as i,t as n,k as u,F as x,z as I,i as $,m as b,p as O}from"./app-CYSvmcR8.js";import{P as Q,C as T,a as H,_ as G}from"./AppLayout.vue_vue_type_script_setup_true_lang-R4kQx9DT.js";import{_ as g}from"./AppFooter-DaHgPrIF.js";import{_ as w}from"./index-DbHijLDh.js";import{_ as S,a as E,b as h}from"./CardHeader.vue_vue_type_script_setup_true_lang-CazDfcUj.js";import{_ as C}from"./CardDescription.vue_vue_type_script_setup_true_lang-B-VIl_s4.js";import{_ as V}from"./CardTitle.vue_vue_type_script_setup_true_lang-Zu7LdWln.js";import{_ as J,a as K,b as A,c,d as W,e as _}from"./TableCell.vue_vue_type_script_setup_true_lang-BknAQ6j1.js";import{_ as X,a as Y,b as Z,c as tt,d as et}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BitTFnif.js";import{_ as st}from"./Label.vue_vue_type_script_setup_true_lang-C5ivKHaI.js";import{_ as at,a as ot,b as it,c as lt,d as B}from"./SelectItem.vue_vue_type_script_setup_true_lang-P3441g65.js";import{e as R,s as nt}from"./useSweetAlert-DaBq0Crb.js";import{A as dt}from"./arrow-left-BFujA4t7.js";import{P as rt}from"./pencil-Dy5wFOOE.js";import{U as ut}from"./user-zfZ-M4Rd.js";import{D as mt}from"./dollar-sign-Bqh-6XYD.js";import{E as ft}from"./eye-CCw4VRPt.js";import"./useForwardExpose-C04IyDGt.js";import"./RovingFocusGroup-CF_7D-JK.js";import"./ThemeSwitcher.vue_vue_type_script_setup_true_lang-RQb2PAcX.js";import"./VisuallyHidden-BhR3rBEy.js";import"./check-Cq5oJblT.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const ct={class:"py-12"},_t={class:"mx-auto max-w-6xl sm:px-6 lg:px-8 space-y-6"},gt={class:"mb-4"},pt={class:"flex items-start justify-between"},vt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},xt={class:"space-y-4"},bt={class:"flex items-start gap-3"},yt={class:"flex-1"},$t={class:"text-base mt-1"},wt={class:"text-sm text-muted-foreground"},Dt={class:"flex items-start gap-3"},Pt={class:"flex-1"},kt={class:"text-base mt-1"},St={class:"text-sm text-muted-foreground"},Et={class:"space-y-4"},ht={class:"flex items-start gap-3"},Ct={class:"flex-1"},Vt={class:"text-base mt-1"},At={class:"text-sm text-muted-foreground"},Bt={class:"space-y-2"},Rt={key:0,class:"rounded-md border"},Nt={class:"flex justify-end gap-2"},Ft={key:1,class:"text-center py-8 text-muted-foreground"},Lt={key:0,class:"rounded-lg border p-4 bg-muted/50"},jt={class:"space-y-2 text-sm"},Mt={class:"ml-2 font-medium"},qt={class:"ml-2 font-medium"},zt={class:"space-y-2"},Ut={key:0,class:"text-sm text-destructive"},It={class:"flex justify-end gap-3"},ce={__name:"Show",props:{suscripcion:Object},setup(d){const N=d,p=k(!1),v=k(null),m=z({metodo:"efectivo"}),F=r=>{v.value=r,m.metodo="efectivo",p.value=!0},L=()=>{m.post(`/suscripciones/pagar/${v.value.id}`,{onSuccess:()=>{nt({title:"¡Pago Registrado!",text:"El pago ha sido registrado correctamente"}),p.value=!1},onError:r=>{r.error?R({title:"Error",text:r.error}):R({title:"Error",text:"Hubo un problema al registrar el pago"})}})},j=r=>({activo:"default",inactivo:"secondary",suspendido:"destructive"})[r]||"secondary",M=r=>({pagada:"default",impaga:"destructive",pendiente:"secondary",cancelado:"secondary"})[r]||"secondary",q=r=>N.suscripcion.pagos.filter(l=>new Date(l.vence)<new Date(r.vence)&&l.estado==="impaga").length===0,D=r=>{const e=new Date,l=new Date(r);return Math.ceil((l-e)/(1e3*60*60*24))};return(r,e)=>(u(),f(x,null,[s(t(U),{title:"Detalles de Suscripción"}),s(G,null,{header:a(()=>[...e[3]||(e[3]=[o("h2",{class:"text-xl font-semibold leading-tight text-foreground"}," Detalles de Suscripción ",-1)])]),default:a(()=>[o("div",ct,[o("div",_t,[o("div",gt,[s(t(g),{variant:"ghost",size:"sm","as-child":""},{default:a(()=>[s(t(y),{href:"/suscripciones"},{default:a(()=>[s(t(dt),{class:"mr-2 h-4 w-4"}),e[4]||(e[4]=i(" Volver al listado ",-1))]),_:1})]),_:1})]),s(t(S),null,{default:a(()=>[s(t(E),null,{default:a(()=>[o("div",pt,[o("div",null,[s(t(V),{class:"text-2xl"},{default:a(()=>[i("Suscripción #"+n(d.suscripcion.id),1)]),_:1}),s(t(C),{class:"mt-1"},{default:a(()=>[s(t(w),{variant:j(d.suscripcion.estado),class:"mt-2"},{default:a(()=>[i(n(d.suscripcion.estado),1)]),_:1},8,["variant"])]),_:1})]),s(t(g),{"as-child":""},{default:a(()=>[s(t(y),{href:`/suscripciones/${d.suscripcion.id}/edit`},{default:a(()=>[s(t(rt),{class:"mr-2 h-4 w-4"}),e[5]||(e[5]=i(" Editar ",-1))]),_:1},8,["href"])]),_:1})])]),_:1}),s(t(h),{class:"space-y-6"},{default:a(()=>[o("div",vt,[o("div",xt,[o("div",bt,[s(t(ut),{class:"mt-1 h-5 w-5 text-muted-foreground"}),o("div",yt,[e[6]||(e[6]=o("label",{class:"text-sm font-medium text-muted-foreground"},"Cliente",-1)),o("p",$t,n(d.suscripcion.usuario?.name),1),o("p",wt,n(d.suscripcion.usuario?.email),1)])]),o("div",Dt,[s(t(Q),{class:"mt-1 h-5 w-5 text-muted-foreground"}),o("div",Pt,[e[7]||(e[7]=o("label",{class:"text-sm font-medium text-muted-foreground"},"Paquete",-1)),o("p",kt,n(d.suscripcion.paquete?.nombre),1),o("p",St,n(d.suscripcion.paquete?.membresia?.nombre)+" - Bs "+n(Number(d.suscripcion.paquete?.precio).toFixed(2)),1)])])]),o("div",Et,[o("div",ht,[s(t(T),{class:"mt-1 h-5 w-5 text-muted-foreground"}),o("div",Ct,[e[8]||(e[8]=o("label",{class:"text-sm font-medium text-muted-foreground"},"Periodo",-1)),o("p",Vt,n(new Date(d.suscripcion.fecha_inicio).toLocaleDateString("es-ES"))+" - "+n(new Date(d.suscripcion.fecha_fin).toLocaleDateString("es-ES")),1),o("p",At,[D(d.suscripcion.fecha_fin)>0?(u(),f(x,{key:0},[i(n(D(d.suscripcion.fecha_fin))+" días restantes ",1)],64)):(u(),f(x,{key:1},[i(" Vencida ")],64))])])]),o("div",Bt,[e[9]||(e[9]=o("label",{class:"text-sm font-medium text-muted-foreground"},"Renovación Automática",-1)),o("div",null,[s(t(w),{variant:d.suscripcion.renovacion_automatica?"default":"secondary"},{default:a(()=>[i(n(d.suscripcion.renovacion_automatica?"Activada":"Desactivada"),1)]),_:1},8,["variant"])])])])])]),_:1})]),_:1}),s(t(S),null,{default:a(()=>[s(t(E),null,{default:a(()=>[s(t(V),{class:"flex items-center gap-2"},{default:a(()=>[s(t(H),{class:"h-5 w-5"}),e[10]||(e[10]=i(" Pagos / Cuotas ",-1))]),_:1}),s(t(C),null,{default:a(()=>[i(" Total de "+n(d.suscripcion.pagos?.length||0)+" cuota(s) ",1)]),_:1})]),_:1}),s(t(h),null,{default:a(()=>[d.suscripcion.pagos&&d.suscripcion.pagos.length>0?(u(),f("div",Rt,[s(t(J),null,{default:a(()=>[s(t(K),null,{default:a(()=>[s(t(A),null,{default:a(()=>[s(t(c),null,{default:a(()=>[...e[11]||(e[11]=[i("Cuota",-1)])]),_:1}),s(t(c),null,{default:a(()=>[...e[12]||(e[12]=[i("Monto",-1)])]),_:1}),s(t(c),null,{default:a(()=>[...e[13]||(e[13]=[i("Estado",-1)])]),_:1}),s(t(c),null,{default:a(()=>[...e[14]||(e[14]=[i("Método",-1)])]),_:1}),s(t(c),null,{default:a(()=>[...e[15]||(e[15]=[i("Fecha Pago",-1)])]),_:1}),s(t(c),null,{default:a(()=>[...e[16]||(e[16]=[i("Vence",-1)])]),_:1}),s(t(c),{class:"text-right"},{default:a(()=>[...e[17]||(e[17]=[i("Acciones",-1)])]),_:1})]),_:1})]),_:1}),s(t(W),null,{default:a(()=>[(u(!0),f(x,null,I(d.suscripcion.pagos,(l,P)=>(u(),$(t(A),{key:l.id},{default:a(()=>[s(t(_),{class:"font-medium"},{default:a(()=>[i(" Cuota "+n(P+1),1)]),_:2},1024),s(t(_),null,{default:a(()=>[i(" Bs "+n(Number(l.monto).toFixed(2)),1)]),_:2},1024),s(t(_),null,{default:a(()=>[s(t(w),{variant:M(l.estado)},{default:a(()=>[i(n(l.estado),1)]),_:2},1032,["variant"])]),_:2},1024),s(t(_),null,{default:a(()=>[i(n(l.metodo||"-"),1)]),_:2},1024),s(t(_),null,{default:a(()=>[i(n(l.fecha?new Date(l.fecha).toLocaleDateString("es-ES"):"-"),1)]),_:2},1024),s(t(_),null,{default:a(()=>[i(n(new Date(l.vence).toLocaleDateString("es-ES")),1)]),_:2},1024),s(t(_),{class:"text-right"},{default:a(()=>[o("div",Nt,[l.estado==="impaga"&&q(l)?(u(),$(t(g),{key:0,variant:"default",size:"sm",onClick:Ot=>F(l)},{default:a(()=>[s(t(mt),{class:"h-4 w-4 mr-1"}),e[18]||(e[18]=i(" Pagar ",-1))]),_:1},8,["onClick"])):b("",!0),l.estado==="pagada"?(u(),$(t(g),{key:1,variant:"ghost",size:"sm","as-child":""},{default:a(()=>[s(t(y),{href:`/recibos/${l.id}`,target:"_blank"},{default:a(()=>[s(t(ft),{class:"h-4 w-4 mr-1"}),e[19]||(e[19]=i(" Ver Recibo ",-1))]),_:1},8,["href"])]),_:2},1024)):b("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):(u(),f("div",Ft,[...e[20]||(e[20]=[o("p",null,"No hay pagos registrados",-1)])]))]),_:1})]),_:1}),s(t(X),{open:p.value,"onUpdate:open":e[2]||(e[2]=l=>p.value=l)},{default:a(()=>[s(t(Y),{class:"sm:max-w-[425px]"},{default:a(()=>[s(t(Z),null,{default:a(()=>[s(t(tt),null,{default:a(()=>[...e[21]||(e[21]=[i("Registrar Pago",-1)])]),_:1}),s(t(et),null,{default:a(()=>[...e[22]||(e[22]=[i(" Registre el pago de la cuota seleccionada ",-1)])]),_:1})]),_:1}),o("form",{onSubmit:O(L,["prevent"]),class:"space-y-4"},[v.value?(u(),f("div",Lt,[e[25]||(e[25]=o("h4",{class:"text-sm font-medium mb-2"},"Detalles del Pago",-1)),o("div",jt,[o("div",null,[e[23]||(e[23]=o("span",{class:"text-muted-foreground"},"Monto:",-1)),o("span",Mt,"Bs "+n(Number(v.value.monto).toFixed(2)),1)]),o("div",null,[e[24]||(e[24]=o("span",{class:"text-muted-foreground"},"Vence:",-1)),o("span",qt,n(new Date(v.value.vence).toLocaleDateString("es-ES")),1)])])])):b("",!0),o("div",zt,[s(t(st),{for:"metodo"},{default:a(()=>[...e[26]||(e[26]=[i("Método de Pago *",-1)])]),_:1}),s(t(at),{modelValue:t(m).metodo,"onUpdate:modelValue":e[0]||(e[0]=l=>t(m).metodo=l),required:""},{default:a(()=>[s(t(ot),{id:"metodo"},{default:a(()=>[s(t(it),{placeholder:"Selecciona un método"})]),_:1}),s(t(lt),null,{default:a(()=>[s(t(B),{value:"efectivo"},{default:a(()=>[...e[27]||(e[27]=[i("Efectivo",-1)])]),_:1}),s(t(B),{value:"QR"},{default:a(()=>[...e[28]||(e[28]=[i("QR",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(m).errors.metodo?(u(),f("span",Ut,n(t(m).errors.metodo),1)):b("",!0)]),o("div",It,[s(t(g),{type:"button",variant:"outline",onClick:e[1]||(e[1]=l=>p.value=!1)},{default:a(()=>[...e[29]||(e[29]=[i(" Cancelar ",-1)])]),_:1}),s(t(g),{type:"submit",disabled:t(m).processing},{default:a(()=>[i(n(t(m).processing?"Procesando...":"Registrar Pago"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1},8,["open"])])])]),_:1})],64))}};export{ce as default};
